
## 什么是即时通讯(Instant Messaging)

大家眼中的即时通讯主要是QQ, 微信，旺旺等。其实远不止这些。

本文说的也主要是聊天、群组这类的即时通讯。

## 协议的设计

(1) 协议(protocol): 两者通信共同时遵守的规则
(2) IM客户端协议: client/server的约定
(3) IM服务器内部协议(RPC): server/server的约定

> 本文说的协议主要是2：客户端到服务端的协议

### 二进制协议

im_protocol.jpg

可读性差，安全性高，传输速度快

### 文本协议

text_protocol.jpg

MSN 是用的文本协议

性能比较差，需要一行一行的读取，安全性差

### 流式XML

XMPP, Gtalk 使用的是XML协议

### 常见协议栈

传输层协议：TCP
安全层协议：加解密
pb

#### 安全层协议

方案一：使用每个人独有的秘钥来加密

方案二：动态秘钥

#### 应用层协议设计

- 扩展性
- 效率


## 模块

## 架构

## 流程

## 其他
